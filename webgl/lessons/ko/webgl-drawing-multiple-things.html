<!DOCTYPE html>
<!-- this file is auto-generated from webgl/lessons/ko/webgl-drawing-multiple-things.md. Do not edited directly -->
<!--
Copyright 2021 GFXFundamentals.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are
met:

*   Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.

*   Redistributions in binary form must reproduce the above
    copyright notice, this list of conditions and the following disclaimer
    in the documentation and/or other materials provided with the
    distribution.

*   Neither the name of GFXFundamentals. nor the names of his
    contributors may be used to endorse or promote products derived from
    this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-->
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="WebGL에서 다른 종류의 여러 물체를 그리는 방법">
<meta name="keywords" content="webgl graphics">
<meta name="thumbnail" content="https://webglfundamentals.org/webgl/lessons/screenshots/webgl-drawing-multiple-things_ko.jpg">

<meta property="og:title" content="WebGL - 여러 물체 그리기">
<meta property="og:type" content="website">
<meta property="og:image" content="https://webglfundamentals.org/webgl/lessons/screenshots/webgl-drawing-multiple-things_ko.jpg">
<meta property="og:description" content="WebGL에서 다른 종류의 여러 물체를 그리는 방법">
<meta property="og:url" content="https://webglfundamentals.org/webgl/lessons/ko/webgl-drawing-multiple-things.html">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@greggman">
<meta name="twitter:creator" content="@greggman">
<meta name="twitter:domain" content="webglfundamentals.org">
<meta name="twitter:title" content="WebGL - 여러 물체 그리기">
<meta name="twitter:url" content="https://webglfundamentals.org/webgl/lessons/ko/webgl-drawing-multiple-things.html">
<meta name="twitter:description" content="WebGL에서 다른 종류의 여러 물체를 그리는 방법">
<meta name="twitter:image:src" content="https://webglfundamentals.org/webgl/lessons/screenshots/webgl-drawing-multiple-things_ko.jpg">

<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@graph":[
    {
      "@type":"WebSite",
      "@id":"https://webglfundamentals.org/#website",
      "url":"https://webglfundamentals.org/",
      "name":"WebglFundamentals"
    },
    {
      "@type":"ImageObject",
      "@id":"https://webglfundamentals.org/webgl/lessons/ko/webgl-drawing-multiple-things.html#primaryimage",
      "url":"https://webglfundamentals.org/webgl/lessons/screenshots/webgl-drawing-multiple-things_ko.jpg",
      "width":1200,
      "height":630
    },
    {
      "@type":"WebPage",
      "@id":"https://webglfundamentals.org/webgl/lessons/ko/webgl-drawing-multiple-things.html#webpage",
      "url":"https://webglfundamentals.org/webgl/lessons/ko/webgl-drawing-multiple-things.html",
      "inLanguage":"ko",
      "name":"WebGL - 여러 물체 그리기",
      "keywords":"webgl graphics programming",
      "isPartOf":{
        "@id":"https://webglfundamentals.org/#website"
      },
      "primaryImageOfPage":{
        "@id":"https://webglfundamentals.org/webgl/lessons/ko/webgl-drawing-multiple-things.html#primaryimage"
      }
    }
  ]
}
</script>


<title>WebGL - 여러 물체 그리기</title>
<link href="/webgl/lessons/resources/webglfundamentals-icon.png" rel="shortcut icon" type="image/png">
<link rel="stylesheet" href="/webgl/lessons/lang.css">
<link rel="stylesheet" href="/webgl/lessons/ko/lang.css">
<link rel="stylesheet" href="/webgl/lessons/resources/lesson.css">

  <link rel="alternate" hreflang="en" href="https://webglfundamentals.org/webgl/lessons/webgl-drawing-multiple-things.html">
  <link rel="alternate" hreflang="fr" href="https://webglfundamentals.org/webgl/lessons/fr/webgl-drawing-multiple-things.html">
  <link rel="alternate" hreflang="ja" href="https://webglfundamentals.org/webgl/lessons/ja/webgl-drawing-multiple-things.html">
  <link rel="alternate" hreflang="ko" href="https://webglfundamentals.org/webgl/lessons/ko/webgl-drawing-multiple-things.html">
  <link rel="alternate" hreflang="pl" href="https://webglfundamentals.org/webgl/lessons/pl/webgl-drawing-multiple-things.html">
  <link rel="alternate" hreflang="pt-br" href="https://webglfundamentals.org/webgl/lessons/pt-br/webgl-drawing-multiple-things.html">
  <link rel="alternate" hreflang="ru" href="https://webglfundamentals.org/webgl/lessons/ru/webgl-drawing-multiple-things.html">
  <link rel="alternate" hreflang="zh_cn" href="https://webglfundamentals.org/webgl/lessons/zh_cn/webgl-drawing-multiple-things.html">




</head>
<body>
<div class="webgl_navbar">
  <div>
    <select class="language">
    <option value="/webgl/lessons/webgl-drawing-multiple-things.html" >English</a>
    <option value="/webgl/lessons/fr/webgl-drawing-multiple-things.html" >Français</a>
    <option value="/webgl/lessons/ja/webgl-drawing-multiple-things.html" >日本語</a>
    <option value="/webgl/lessons/ko/webgl-drawing-multiple-things.html" selected>한국어</a>
    <option value="/webgl/lessons/pl/webgl-drawing-multiple-things.html" >Polski</a>
    <option value="/webgl/lessons/pt-br/webgl-drawing-multiple-things.html" >Portuguese</a>
    <option value="/webgl/lessons/ru/webgl-drawing-multiple-things.html" >Русский</a>
    <option value="/webgl/lessons/zh_cn/webgl-drawing-multiple-things.html" >简体中文</a>
</select>


    <a href="#toc">목차</a>
  </div>
</div>
<div class="webgl_header">
  <h1><a href="/webgl/lessons/ko/">WebGLFundamentals.org</a></h1>
<style>
#forkongithub>div {
    background: #000;
    color: #fff;
    font-family: arial,sans-serif;
    text-align: center;
    font-weight: bold;
    padding: 5px 40px;
    font-size: 0.9rem;
    line-height: 1.3rem;
    position: relative;
    transition: 0.5s;
    display: block;
    width: 400px;
    position: absolute;
    top: 0;
    right: 0;
    transform: translateX(200px) rotate(45deg) translate(10px,70px);
    box-shadow: 4px 4px 10px rgba(0,0,0,0.8);
    pointer-events: auto;
}
#forkongithub a {
  text-decoration: none;
  color: #fff;
}
#forkongithub>div:hover {
    background: #c11;
    color: #fff;
}
#forkongithub .contributors {
  font-size: 0.75rem;
  background: rgba(255,255,255,0.2);
  line-height: 1.2;
  padding: 0.1em;
}
#forkongithub>div::before,#forkongithub>div::after {
    content: "";
    width: 100%;
    display: block;
    position: absolute;
    top: 1px;
    left: 0;
    height: 1px;
    background: #fff;
}
#forkongithub>div::after {
    bottom: 1px;
    top: auto;
}

#forkongithub{
    z-index: 9999;
    /* needed for firefox */
    overflow: hidden;
    width: 300px;
    height: 300px;
    position: absolute;
    right: 0;
    top: 0;
    pointer-events: none;
}
#forkongithub svg{
  width: 1em;
  height: 1em;
  vertical-align: middle;
}
#forkongithub img {
  width: 1em;
  height: 1em;
  border-radius: 100%;
  vertical-align: middle;
}

@media (max-width: 900px) {
    #forkongithub>div {
        line-height: 1.2rem;
    }
}
@media (max-width: 700px) {
  #forkongithub {
    display: none;
  }
}
@media (max-width: 410px) {
    #forkongithub>div {
        font-size: 0.7rem;
        transform: translateX(150px) rotate(45deg) translate(20px,40px);
    }
}

</style>
<div id="forkongithub"><div><div><a href="https://github.com/gfxfundamentals/webgl-fundamentals">Fix, Fork, Contribute <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 136 133" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(3.92891,0,0,3.92891,67.867,129.125)">
        <path d="M0,-31.904C-8.995,-31.904 -16.288,-24.611 -16.288,-15.614C-16.288,-8.417 -11.621,-2.312 -5.148,-0.157C-4.333,-0.008 -4.036,-0.511 -4.036,-0.943C-4.036,-1.329 -4.05,-2.354 -4.058,-3.713C-8.589,-2.729 -9.545,-5.897 -9.545,-5.897C-10.286,-7.779 -11.354,-8.28 -11.354,-8.28C-12.833,-9.29 -11.242,-9.27 -11.242,-9.27C-9.607,-9.155 -8.747,-7.591 -8.747,-7.591C-7.294,-5.102 -4.934,-5.821 -4.006,-6.238C-3.858,-7.29 -3.438,-8.008 -2.972,-8.415C-6.589,-8.826 -10.392,-10.224 -10.392,-16.466C-10.392,-18.244 -9.757,-19.698 -8.715,-20.837C-8.883,-21.249 -9.442,-22.905 -8.556,-25.148C-8.556,-25.148 -7.188,-25.586 -4.076,-23.478C-2.777,-23.84 -1.383,-24.02 0.002,-24.026C1.385,-24.02 2.779,-23.84 4.08,-23.478C7.19,-25.586 8.555,-25.148 8.555,-25.148C9.444,-22.905 8.885,-21.249 8.717,-20.837C9.761,-19.698 10.392,-18.244 10.392,-16.466C10.392,-10.208 6.583,-8.831 2.954,-8.428C3.539,-7.925 4.06,-6.931 4.06,-5.411C4.06,-3.234 4.04,-1.477 4.04,-0.943C4.04,-0.507 4.333,0 5.16,-0.159C11.628,-2.318 16.291,-8.419 16.291,-15.614C16.291,-24.611 8.997,-31.904 0,-31.904" style="fill:white;"/>
    </g>
</svg>
</a></div></div></div>

</div>


<div class="container">
  <div class="lesson-title">
    <h1>WebGL - 여러 물체 그리기</h1>
  </div>
  <div class="lesson">
    <div class="lesson-main">
      <p>이 글은 <a href="webgl-fundamentals.html">기초</a>에서 이어집니다.
아직 읽지 않았다면 거기부터 시작하는 게 좋습니다.</p>
<p>처음으로 WebGL에서 무언가를 한 다음 물어보는 대다수의 공통적인 질문 중 하나는 어떻게 여러 물체를 그리는가 입니다.</p>
<p>먼저 알아야 할 점은 몇 가지 예외를 제외하고, WebGL은 함수에 매개변수를 많이 전달하는 대신, 물체를 그리는 단일 함수와 해당 함수를 위한 70개 이상의 상태 설정 함수가 있습니다.
예를 들어 원을 그리는 함수가 있다고 상상해보세요.
이는 다음과 같이 프로그래밍할 수 있습니다.</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">function drawCircle(centerX, centerY, radius, color) { ... }
</code></pre><p>혹은 이렇게 코드를 짤 수도 있겠죠.</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">var centerX;
var centerY;
var radius;
var color;

function setCenter(x, y) {
  centerX = x;
  centerY = y;
}

function setRadius(r) {
  radius = r;
}

function setColor(c) {
  color = c;
}

function drawCircle() {
  ...
}
</code></pre><p>WebGL은 두 번째 방법으로 동작하는데요.
<code class="notranslate" translate="no">gl.createBuffer</code>, <code class="notranslate" translate="no">gl.bufferData</code>, <code class="notranslate" translate="no">gl.createTexture</code>, <code class="notranslate" translate="no">gl.texImage2D</code>와 같은 함수들은 버퍼(vertex)와 텍스처(color, etc..) 데이터를 WebGL에 업로드 해줍니다.
<code class="notranslate" translate="no">gl.createProgram</code>, <code class="notranslate" translate="no">gl.createShader</code>, <code class="notranslate" translate="no">gl.compileShader</code>, <code class="notranslate" translate="no">gl.linkProgram</code>과 같은 함수들은 GLSL 셰이더를 만들어 줍니다.
그 외 WebGL의 거의 모든 함수들은 이러한 전역 변수나 <em>상태</em>를 설정하여 최종적으로 <code class="notranslate" translate="no">gl.drawArrays</code>나 <code class="notranslate" translate="no">gl.drawElements</code>가 호출될 때 사용됩니다.</p>
<p>전형적인 WebGL 프로그램은 기본적으로 이런 구조를 따릅니다.</p>
<p>초기화할 때</p>
<ul>
<li>모든 셰이더와 프로그램을 만들고 위치 탐색</li>
<li>버퍼를 생성하고 정점 데이터 업로드</li>
<li>텍스처를 생성하고 텍스처 데이터 업로드</li>
</ul>
<p>렌더링할 때</p>
<ul>
<li>뷰포트와 전역 상태를 지우고 설정
(깊이 테스트 활성화, 컬링 활성화, 등등..)</li>
<li>그리려는 각각에 대해<ul>
<li>그려야 하는 프로그램에 대해 <code class="notranslate" translate="no">gl.useProgram</code> 호출</li>
<li>그리려는 것에 대한 속성 설정<ul>
<li>각각의 속성에 대해 <code class="notranslate" translate="no">gl.bindBuffer</code>, <code class="notranslate" translate="no">gl.vertexAttribPointer</code>, <code class="notranslate" translate="no">gl.enableVertexAttribArray</code> 호출</li>
</ul>
</li>
<li>그리려는 것에 대한 유니폼 설정<ul>
<li>각각의 유니폼에 대한 <code class="notranslate" translate="no">gl.uniformXXX</code> 호출</li>
<li><code class="notranslate" translate="no">gl.activeTexture</code>와 <code class="notranslate" translate="no">gl.bindTexture</code>를 호출하여 텍스처 유닛에 텍스처 할당</li>
</ul>
</li>
<li><code class="notranslate" translate="no">gl.drawArrays</code> 혹은 <code class="notranslate" translate="no">gl.drawElements</code> 호출</li>
</ul>
</li>
</ul>
<p>기본적으로 이렇습니다.
해당 작업을 해내기 위해 어떻게 코드를 구성하냐는 여러분이 정하시면 됩니다.</p>
<p>텍스처 데이터(또한 정점 데이터) 업로드같은 일부 작업은 인터넷으로 다운로드가 끝날 때까지 기다려야 하기 때문에 비동기적으로 발생할 수 있습니다.</p>
<p>3가지 물체를 그리는 간단한 앱을 만들어봅시다.
큐브와 구체 그리고 원뿔입니다.</p>
<p>큐브, 구체, 원뿔 데이터를 계산하는 방법에 대해 자세히 설명하진 않겠습니다.
그냥 이들을 생성하는 함수가 있고 <a href="webgl-less-code-more-fun.html">이전 글</a>에서 설명한 <code class="notranslate" translate="no">bufferInfo</code> 객체가 반환된다고 가정해봅시다.</p>
<p>여기 해당 코드입니다.
정점 색상을 곱하기 위해 <code class="notranslate" translate="no">u_colorMult</code>를 추가한 걸 제외하고는 <a href="webgl-3d-perspective.html">원근 투영 예제</a>와 같은 간단한 셰이더입니다.</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">// 정점 셰이더에서 전달됩니다.
varying vec4 v_color;

uniform vec4 u_colorMult;

void main() {
  gl_FragColor = v_color * u_colorMult;
}
</code></pre><p>초기화할 때</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">// 그리려는 각각에 대한 유니폼
var sphereUniforms = {
  u_colorMult: [0.5, 1, 0.5, 1],
  u_matrix: m4.identity(),
};
var cubeUniforms = {
  u_colorMult: [1, 0.5, 0.5, 1],
  u_matrix: m4.identity(),
};
var coneUniforms = {
  u_colorMult: [0.5, 0.5, 1, 1],
  u_matrix: m4.identity(),
};

// 각 객체에 대한 평행 이동
var sphereTranslation = [  0, 0, 0];
var cubeTranslation   = [-40, 0, 0];
var coneTranslation   = [ 40, 0, 0];
</code></pre><p>그릴 때</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">var sphereXRotation =  time;
var sphereYRotation =  time;
var cubeXRotation   = -time;
var cubeYRotation   =  time;
var coneXRotation   =  time;
var coneYRotation   = -time;

// ------ 구체 그리기 --------

gl.useProgram(programInfo.program);

// 필요한 모든 속성 설정
webglUtils.setBuffersAndAttributes(gl, programInfo, sphereBufferInfo);

sphereUniforms.u_matrix = computeMatrix(
  viewProjectionMatrix,
  sphereTranslation,
  sphereXRotation,
  sphereYRotation);

// 계산한 유니폼 설정
webglUtils.setUniforms(programInfo, sphereUniforms);

gl.drawArrays(gl.TRIANGLES, 0, sphereBufferInfo.numElements);

// ------ 큐브 그리기 --------

// 필요한 모든 속성 설정
webglUtils.setBuffersAndAttributes(gl, programInfo, cubeBufferInfo);

cubeUniforms.u_matrix = computeMatrix(
  viewProjectionMatrix,
  cubeTranslation,
  cubeXRotation,
  cubeYRotation);

// 계산한 유니폼 설정
webglUtils.setUniforms(programInfo, cubeUniforms);

gl.drawArrays(gl.TRIANGLES, 0, cubeBufferInfo.numElements);

// ------ 원뿔 그리기 --------

// 필요한 모든 속성 설정
webglUtils.setBuffersAndAttributes(gl, programInfo, coneBufferInfo);

coneUniforms.u_matrix = computeMatrix(
    viewProjectionMatrix,
    coneTranslation,
    coneXRotation,
    coneYRotation);

// 계산한 유니폼 설정
webglUtils.setUniforms(programInfo, coneUniforms);

gl.drawArrays(gl.TRIANGLES, 0, coneBufferInfo.numElements);
</code></pre><p>그리고 여기 결과입니다.</p>
<p><div class="webgl_example_container">
  <iframe class="webgl_example" style=" " src="/webgl/resources/editor.html?url=/webgl/lessons/..%2Fwebgl-multiple-objects-manual.html"></iframe>
  <a class="webgl_center" href="/webgl/lessons/../webgl-multiple-objects-manual.html" target="_blank">새 창을 열려면 여기를 클릭</a>
</div>

</p>
<p>한 가지 주목할 점은 셰이더 프로그램이 하나뿐이므로 <code class="notranslate" translate="no">gl.useProgram</code>을 한 번만 호출한다는 겁니다.
만약 다른 셰이더 프로그램을 가지고 있다면 각 프로그램을 사용하기 전에 <code class="notranslate" translate="no">gl.useProgram</code>을 호출해야 합니다.</p>
<p>이 또한 단순화하기 좋은데요.
실질적으로 갖춰야 할 3가지 주요 사항은 아래와 같습니다.</p>
<ol>
<li>셰이더 프로그램 (그리고 유니폼과 속성의 정보/설정자)</li>
<li>그리려는 것에 대한 버퍼와 속성</li>
<li>주어진 셰이더로 해당 물체를 그리는데 필요한 유니폼</li>
</ol>
<p>따라서 간단하 단순화는 물체의 배열을 만들고 그 배열에 3가지 물체를 모으는 겁니다.</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">var objectsToDraw = [
  {
    programInfo: programInfo,
    bufferInfo: sphereBufferInfo,
    uniforms: sphereUniforms,
  },
  {
    programInfo: programInfo,
    bufferInfo: cubeBufferInfo,
    uniforms: cubeUniforms,
  },
  {
    programInfo: programInfo,
    bufferInfo: coneBufferInfo,
    uniforms: coneUniforms,
  },
];
</code></pre><p>그릴 때 행렬도 업데이트해야 합니다.</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">var sphereXRotation =  time;
var sphereYRotation =  time;
var cubeXRotation   = -time;
var cubeYRotation   =  time;
var coneXRotation   =  time;
var coneYRotation   = -time;

// 각 객체에 대한 행렬 계산
sphereUniforms.u_matrix = computeMatrix(
    viewProjectionMatrix,
    sphereTranslation,
    sphereXRotation,
    sphereYRotation);

cubeUniforms.u_matrix = computeMatrix(
    viewProjectionMatrix,
    cubeTranslation,
    cubeXRotation,
    cubeYRotation);

coneUniforms.u_matrix = computeMatrix(
    viewProjectionMatrix,
    coneTranslation,
    coneXRotation,
    coneYRotation);
</code></pre><p>이제 그리는 코드는 단순 반복일 뿐입니다.</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">// ------ 객체 그리기 --------

objectsToDraw.forEach(function(object) {
  var programInfo = object.programInfo;
  var bufferInfo = object.bufferInfo;

  gl.useProgram(programInfo.program);

  // 필요한 모든 속성 설정
  webglUtils.setBuffersAndAttributes(gl, programInfo, bufferInfo);

  // 유니폼 설정
  webglUtils.setUniforms(programInfo, object.uniforms);

  // 그리기
  gl.drawArrays(gl.TRIANGLES, 0, bufferInfo.numElements);
});
</code></pre><p>그리고 이건 현존하는 대다수 3D 엔진의 주요 렌더링 루프입니다.
일부 코드 혹은 코드들이 <code class="notranslate" translate="no">objectsToDraw</code> 목록에 들어갈 내용을 결정하지만 기본적으로는 그게 전부입니다.</p>
<p><div class="webgl_example_container">
  <iframe class="webgl_example" style=" " src="/webgl/resources/editor.html?url=/webgl/lessons/..%2Fwebgl-multiple-objects-list.html"></iframe>
  <a class="webgl_center" href="/webgl/lessons/../webgl-multiple-objects-list.html" target="_blank">새 창을 열려면 여기를 클릭</a>
</div>

</p>
<p>몇 가지 기본적인 최적화가 있는데요.
그리려는 프로그램이 이전에 그렸던 프로그램과 같다면 <code class="notranslate" translate="no">gl.useProgram</code>을 호출할 필요가 없습니다.
마찬가지로 이전에 그렸던 것과 동일한 도형/지오메트리/정점을 그린다면 다시 설정할 필요가 없겠죠.</p>
<p>따라서 다음과 같이 최적화할 수 있습니다.</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">var lastUsedProgramInfo = null;
var lastUsedBufferInfo = null;

objectsToDraw.forEach(function(object) {
  var programInfo = object.programInfo;
  var bufferInfo = object.bufferInfo;
  var bindBuffers = false;

  if (programInfo !== lastUsedProgramInfo) {
    lastUsedProgramInfo = programInfo;
    gl.useProgram(programInfo.program);

    // 프로그램이 사용하는 버퍼만 바인딩하기 때문에 프로그램이 바뀔 때마다 버퍼를 다시 바인딩해야 합니다.
    // 따라서 2개의 프로그램이 동일한 &quot;bufferInfo&quot;를 사용하지만 첫 번째 버퍼가 위치만 사용하면 두 번째 버퍼로 전환할 때 속성 중 일부는 활성화되지 않을 겁니다.
    bindBuffers = true;
  }

  // 필요한 모든 속성 설정
  if (bindBuffers || bufferInfo != lastUsedBufferInfo) {
    lastUsedBufferInfo = bufferInfo;
    webglUtils.setBuffersAndAttributes(gl, programInfo, bufferInfo);
  }

  // 유니폼 설정
  webglUtils.setUniforms(programInfo, object.uniforms);

  // 그리기
  gl.drawArrays(gl.TRIANGLES, 0, bufferInfo.numElements);
});
</code></pre><p>이번엔 더 많은 객체를 그려 보겠습니다.
이전처럼 3개 대신 그리는 목록을 더 크게 만들어봅시다.</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">// 무작위로 선택하기 쉽도록 도형을 배열에 넣기
var shapes = [
  sphereBufferInfo,
  cubeBufferInfo,
  coneBufferInfo,
];

// 그리기 위한 배열, 조작하기 위한 배열, 객체 배열 2개 만들기
var objectsToDraw = [];
var objects = [];

// 각 객체에 대한 유니폼
var numObjects = 200;
for (var ii = 0; ii &lt; numObjects; ++ii) {
  // 도형 선택
  var bufferInfo = shapes[rand(0, shapes.length) | 0];

  // 객체 만들기
  var object = {
    uniforms: {
      u_colorMult: [rand(0, 1), rand(0, 1), rand(0, 1), 1],
      u_matrix: m4.identity(),
    },
    translation: [rand(-100, 100), rand(-100, 100), rand(-150, -50)],
    xRotationSpeed: rand(0.8, 1.2),
    yRotationSpeed: rand(0.8, 1.2),
  };
  objects.push(object);

  // 그리는 목록에 추가
  objectsToDraw.push({
    programInfo: programInfo,
    bufferInfo: bufferInfo,
    uniforms: object.uniforms,
  });
}
</code></pre><p>렌더링할 때</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">// 각 객체에 대한 행렬 계산
objects.forEach(function(object) {
  object.uniforms.u_matrix = computeMatrix(
      viewMatrix,
      projectionMatrix,
      object.translation,
      object.xRotationSpeed * time,
      object.yRotationSpeed * time);
});
</code></pre><p>그런 다음 위 루프를 사용하여 객체를 그립니다.</p>
<p><div class="webgl_example_container">
  <iframe class="webgl_example" style=" " src="/webgl/resources/editor.html?url=/webgl/lessons/..%2Fwebgl-multiple-objects-list-optimized.html"></iframe>
  <a class="webgl_center" href="/webgl/lessons/../webgl-multiple-objects-list-optimized.html" target="_blank">새 창을 열려면 여기를 클릭</a>
</div>

</p>
<p>또한 최적화를 더 자주하도록 <code class="notranslate" translate="no">programInfo</code>나 <code class="notranslate" translate="no">bufferInfo</code>로 정렬할 수 있습니다.
대부분의 게임 엔진은 이를 수행하는데요.
안타깝지만 간단하지 않습니다.
여러분이 그린 모든 게 불투명하면 그냥 정렬하면 됩니다.
하지만 반투명 요소를 그려야 한다면 특정 순서로 그려야 합니다.
대다수의 3D 엔진은 2개 이상의 그리는 객체 목록으로 이를 처리하는데요.
하나는 불투명 요소에 대한 목록입니다.
다른 하나는 투명 요소에 대한 목록입니다.
불투명 목록는 프로그램과 지오메트리로 정렬됩니다.
투명 목록은 깊이로 정렬됩니다.
오버레이나 후처리 효과처럼 다른 것들에 대한 별도의 목록이 있을 수도 있습니다.</p>
<p>여기 <a href="../../webgl-multiple-objects-list-optimized-sorted.html" target="_blank">정렬된 예제</a>입니다.
제 컴퓨터에서는 비정렬일 때 ~31fps, 정렬일 때 ~37fps이 나옵니다.
거의 20% 향상되었네요.
하지만 이는 최악의 경우 vs 최고의 경우이며, 대부분의 프로그램은 더 많은 걸 수행하므로, 특별한 경우를 제외하고는 전부 고려할만한 가치가 없습니다.</p>
<p>일부 셰이더만으로는 일부 지오메트리를 그릴 수 없다는 점에 유의해야 합니다.
예를 들어 법선이 필요한 셰이더는 법선이 없는 지오메트리에서 작동하지 않을 겁니다.
마찬가지로 텍스처가 필요한 셰이더는 텍스처 없이는 작동하지 않습니다.</p>
<p>이 모든 걸 처리하기 때문에 <a href="https://threejs.org">Three.js</a>같은 3D 라이브러리를 선택하는 것이 좋습니다.
몇 가지 지오메트리를 만들고, 어떻게 렌더링하고 싶은지 three.js에 지시하면, 런타임에 필요한 것들을 처리하기 위해 셰이더를 생성합니다.
Unity3D, Unreal, Source, Crytek 등 거의 모든 3D 엔진들이 이를 수행합니다.
일부는 오프라인으로 생성되지만 중요한 점은 셰이더를 <em>생성</em>한다는 겁니다.</p>
<p>물론 여러분이 이러한 글들을 읽는 이유는 내부에서 무슨 일이 일어나는지 알고 싶어하기 때문입니다.
그건 훌륭하고 모든 걸 직접 작성하는 것은 재미있습니다.
하지만 <a href="webgl-2d-vs-3d-library.html">WebGL은 굉장히 로우 레벨</a>이므로, 직접 하고 싶다면 해야 할 작업들이 많고, 다른 기능들은 종종 다른 셰이더가 필요하기 때문에, 대부분 셰이더 생성기 작성이 포함됩니다.</p>
<p>루프 안에 <code class="notranslate" translate="no">computeMatrix</code>를 넣지 않았다는 걸 눈치채셨을 겁니다.
이는 렌더링이 행렬 계산과 분리되어야 하기 때문인데요.
일반적으로 <a href="webgl-scene-graph.html">장면 그래프</a>에서 행렬을 계산하는데 이건 또 다른 글에서 설명하겠습니다.</p>
<p>이제 여러 물체를 그리기 위한 프레임워크가 생겼으니 <a href="webgl-text-html.html">텍스트</a>를 그려봅시다.</p>

    </div>
    <div class="lesson-sidebar">
        <select class="language">
    <option value="/webgl/lessons/webgl-drawing-multiple-things.html" >English</a>
    <option value="/webgl/lessons/fr/webgl-drawing-multiple-things.html" >Français</a>
    <option value="/webgl/lessons/ja/webgl-drawing-multiple-things.html" >日本語</a>
    <option value="/webgl/lessons/ko/webgl-drawing-multiple-things.html" selected>한국어</a>
    <option value="/webgl/lessons/pl/webgl-drawing-multiple-things.html" >Polski</a>
    <option value="/webgl/lessons/pt-br/webgl-drawing-multiple-things.html" >Portuguese</a>
    <option value="/webgl/lessons/ru/webgl-drawing-multiple-things.html" >Русский</a>
    <option value="/webgl/lessons/zh_cn/webgl-drawing-multiple-things.html" >简体中文</a>
</select>


        <div id="toc">
          <ul>  <li>기초</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-fundamentals.html">기초</a></li>
<li><a href="/webgl/lessons/ko/webgl-how-it-works.html">작동 방식</a></li>
<li><a href="/webgl/lessons/ko/webgl-shaders-and-glsl.html">셰이더와 GLSL</a></li>
<li><a href="/webgl/lessons/resources/webgl-state-diagram.html">WebGL 상태 다이어그램</a></li>
        </ul>
  <li>이미지 처리</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-image-processing.html">이미지 처리</a></li>
<li><a href="/webgl/lessons/ko/webgl-image-processing-continued.html">이미지 처리 심화</a></li>
        </ul>
  <li>2D 평행 이동, 회전, 스케일, 행렬 수학</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-2d-translation.html">2D 평행 이동</a></li>
<li><a href="/webgl/lessons/ko/webgl-2d-rotation.html">2D 회전</a></li>
<li><a href="/webgl/lessons/ko/webgl-2d-scale.html">2D 스케일</a></li>
<li><a href="/webgl/lessons/ko/webgl-2d-matrices.html">2D 행렬</a></li>
        </ul>
  <li>3D</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-3d-orthographic.html">3D 직교 투영</a></li>
<li><a href="/webgl/lessons/ko/webgl-3d-perspective.html">3D 원근 투영</a></li>
<li><a href="/webgl/lessons/ko/webgl-3d-camera.html">3D 카메라</a></li>
        </ul>
  <li>조명</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-3d-lighting-directional.html">방향성 조명</a></li>
<li><a href="/webgl/lessons/ko/webgl-3d-lighting-point.html">점 조명</a></li>
<li><a href="/webgl/lessons/ko/webgl-3d-lighting-spot.html">스포트라이트</a></li>
        </ul>
  <li>구조와 구성</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-less-code-more-fun.html">유틸리티 함수</a></li>
<li><a href="/webgl/lessons/ko/webgl-drawing-multiple-things.html">여러 물체 그리기</a></li>
<li><a href="/webgl/lessons/ko/webgl-scene-graph.html">장면 그래프</a></li>
        </ul>
  <li>지오메트리</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-3d-geometry-lathe.html">지오메트리 - 선반 가공</a></li>
<li><a href="/webgl/lessons/ko/webgl-load-obj.html">.obj 파일 로딩</a></li>
<li><a href="/webgl/lessons/ko/webgl-load-obj-w-mtl.html">.mtl 파일로 .obj 로딩</a></li>
        </ul>
  <li>텍스처</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-3d-textures.html">텍스처</a></li>
<li><a href="/webgl/lessons/ko/webgl-data-textures.html">데이터 텍스처</a></li>
<li><a href="/webgl/lessons/ko/webgl-2-textures.html">2개 이상의 텍스처 사용</a></li>
<li><a href="/webgl/lessons/ko/webgl-cors-permission.html">교차 출처 이미지</a></li>
<li><a href="/webgl/lessons/ko/webgl-3d-perspective-correct-texturemapping.html">원근 교정 텍스처 매핑</a></li>
<li><a href="/webgl/lessons/ko/webgl-planar-projection-mapping.html">평면 및 원근 투영 매핑</a></li>
        </ul>
  <li>텍스처 렌더링</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-render-to-texture.html">텍스처 렌더링</a></li>
        </ul>
  <li>그림자</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-shadows.html">그림자</a></li>
        </ul>
  <li>기법</li>
        <ul>
            <li>2D</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-2d-drawimage.html">2D - DrawImage</a></li>
<li><a href="/webgl/lessons/ko/webgl-2d-matrix-stack.html">2D - 행렬 스택</a></li>
<li><a href="/webgl/lessons/ko/webgl-sprites.html">스프라이트</a></li>
        </ul>
  <li>3D</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-cube-maps.html">큐브맵</a></li>
<li><a href="/webgl/lessons/ko/webgl-environment-maps.html">환경맵</a></li>
<li><a href="/webgl/lessons/ko/webgl-skybox.html">스카이박스</a></li>
<li><a href="/webgl/lessons/ko/webgl-skinning.html">스키닝</a></li>
<li><a href="/webgl/lessons/ko/webgl-fog.html">안개</a></li>
<li><a href="/webgl/lessons/ko/webgl-picking.html">피킹 (물체 클릭)</a></li>
        </ul>
  <li>텍스트</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-text-html.html">텍스트 - HTML</a></li>
<li><a href="/webgl/lessons/ko/webgl-text-canvas2d.html">텍스트 - Canvas 2D</a></li>
<li><a href="/webgl/lessons/ko/webgl-text-texture.html">텍스트 - 텍스처 사용</a></li>
<li><a href="/webgl/lessons/ko/webgl-text-glyphs.html">텍스트 - 글리프 텍스처 사용</a></li>
        </ul>
  <li>텍스처</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-ramp-textures.html">램프 텍스처 (툰 셰이딩)</a></li>
        </ul>
  <li>GPGPU</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-gpgpu.html">GPGPU</a></li>
        </ul>
        </ul>
  <li>팁</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-smallest-programs.html">최소 프로그램</a></li>
<li><a href="/webgl/lessons/ko/webgl-drawing-without-data.html">데이터 없이 그리기</a></li>
<li><a href="/webgl/lessons/ko/webgl-shadertoy.html">Shadertoy</a></li>
<li><a href="/webgl/lessons/ko/webgl-pulling-vertices.html">정점 풀링</a></li>
        </ul>
  <li>최적화</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-indexed-vertices.html">색인된 정점 (gl.drawElements)</a></li>
<li><a href="/webgl/lessons/ko/webgl-instanced-drawing.html">색인된 그리기</a></li>
        </ul>
  <li>Misc</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-setup-and-installation.html">설정 및 설치</a></li>
<li><a href="/webgl/lessons/ko/webgl-boilerplate.html">상용구</a></li>
<li><a href="/webgl/lessons/ko/webgl-resizing-the-canvas.html">캔버스 크기 조정</a></li>
<li><a href="/webgl/lessons/ko/webgl-animation.html">애니메이션</a></li>
<li><a href="/webgl/lessons/ko/webgl-points-lines-triangles.html">점, 선, 삼각형</a></li>
<li><a href="/webgl/lessons/ko/webgl-multiple-views.html">다중 뷰, 다중 캔버스</a></li>
<li><a href="/webgl/lessons/ko/webgl-visualizing-the-camera.html">카메라 시각화</a></li>
<li><a href="/webgl/lessons/ko/webgl-and-alpha.html">WebGL 알파</a></li>
<li><a href="/webgl/lessons/ko/webgl-2d-vs-3d-library.html">2D vs 3D 라이브러리</a></li>
<li><a href="/webgl/lessons/ko/webgl-anti-patterns.html">안티 패턴</a></li>
<li><a href="/webgl/lessons/ko/webgl-matrix-vs-math.html">WebGL 행렬 vs 수학 행렬</a></li>
<li><a href="/webgl/lessons/ko/webgl-precision-issues.html">정밀도 문제</a></li>
<li><a href="/webgl/lessons/ko/webgl-tips.html#screenshot">스크린샷 찍기</a></li>
<li><a href="/webgl/lessons/ko/webgl-tips.html#preservedrawingbuffer">캔버스 지우기 방지</a></li>
<li><a href="/webgl/lessons/ko/webgl-tips.html#tabindex">캔버스 키보드 입력</a></li>
<li><a href="/webgl/lessons/ko/webgl-tips.html#html-background">WebGL 배경 제작</a></li>
<li><a href="/webgl/lessons/ko/webgl-cross-platform-issues.html">크로스 플랫폼 문제</a></li>
<li><a href="/webgl/lessons/ko/webgl-qna.html">질문 및 답변</a></li>
        </ul>
  <li>참고</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-attributes.html">속성</a></li>
<li><a href="/webgl/lessons/ko/webgl-texture-units.html">텍스처 유닛</a></li>
<li><a href="/webgl/lessons/ko/webgl-framebuffers.html">프레임 버퍼</a></li>
<li><a href="/webgl/lessons/ko/webgl-readpixels.html">readPixels</a></li>
<li><a href="/webgl/lessons/ko/webgl-references.html">참고 자료</a></li>
        </ul></ul>
<ul>
  <li><a href="/docs/">도우미 API 문서</a></li>
  <li><a href="https://twgljs.org">TWGL, 가벼운 WebGL 라이브러리</a></li>
  <li><a href="https://github.com/gfxfundamentals/webgl-fundamentals">Github</a></li>
</ul>

        </div>
    </div>
    <div class="lesson-comments">
        
    <div>이슈/버그는? <a href="https://github.com/gfxfundamentals/webgl-fundamentals/issues">Github</a>에 이슈를 만들어주세요.</div>
    <div class="lesson-comment-notes">
      코드 블록은 <b>&lt;pre&gt;&lt;code&gt;</b>여기에 코드 입력<b>&lt;/code&gt;&lt;/pre&gt;</b>를 사용해주세요
    </div>
  

        <div id="disqus_thread"></div>
        <script>
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'webglfundamentals'; // required: replace example with your forum shortname
            var disqus_identifier = 'WebGL - 여러 물체 그리기';
            var disqus_title = 'WebGL - 여러 물체 그리기';

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                if (window.location.hostname.indexOf("webglfundamentals.org") < 0) {
                    return;
                }
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
  </div>
</div>
</body>
<script>
const settings = {
  contribTemplate: "Thank you <a href=\"${html_url}\"><img src=\"${avatar_url}\"> ${login}</a><br>for <a href=\"https://github.com/${owner}/${repo}/commits?author=${login}\">${contributions} contributions</a>",
  owner: "gfxfundamentals",
  repo: "webgl-fundamentals",
};
</script>
<script src="/contributors.js"></script>
<script src="/3rdparty/jquery-1.11.2.min.js"></script>
<script src="/webgl/lessons/resources/prettify.js"></script>
<script src="/webgl/lessons/resources/lesson.js" type="module"></script>
<script>
(function() {
  if (window.location.hostname.indexOf("webglfundamentals.org") < 0) {
      return;
  }

  function addScript(src, type, fn) {
    const script = document.createElement('script');
    const firstScript = document.getElementsByTagName('script')[0];
    script.async = true;
    script.defer = true;
    script.type = type || 'javascript';
    if (fn) {
      script.addEventListener('load', fn);
    }
    script.src = src;
    firstScript.parentNode.insertBefore(script, firstScript);
  }

  // can't do this because it would eat contexts
  //addScript('//gpustats.org/stats.js', 'module');

  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59804936-1', 'auto');
  ga('send', 'pageview');
}());
</script>


</html>



